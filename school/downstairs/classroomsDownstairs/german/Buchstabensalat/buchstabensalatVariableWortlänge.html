<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Buchstabensalat lange und kurze Worte</title>

    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 0;
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #fdeece;
      }

      main {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        height: 100%;
      }

      .salad-bowl-container {
        position: relative;
        flex: 1;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 0;
      }

      .salad-bowl-container img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
      }

      .salad-word-icon {
        position: absolute;
        top: 28%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 70px;
        opacity: 1;
        pointer-events: none;
        z-index: 1;
      }

      .salad-letters {
        position: absolute;
        inset: 16px;
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        z-index: 2;
      }

      .bowl-letter {
        width: 40px;
        height: 40px;
        border-radius: 5px;
        border: 2px dashed black;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 30px;
        cursor: pointer;
      }

      .bowl-letter:hover {
        transform: scale(1.1);
      }

      .solution-word {
        font-size: 25px;
        margin: 20px 0;
        flex: 0 0 auto;
        display: flex;
        gap: 5px;
      }

      .solution-slot {
        width: 40px;
        height: 40px;
        font-size: 30px;
        text-align: center;
        border: 2px dashed black;
        border-radius: 5px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      #undo-btn {
        padding: 12px 25px;
        font-size: 20px;
        cursor: pointer;
        border: 3px solid white;
        border-radius: 10px;
        flex: 0 0 auto;
        margin-bottom: 20px;
        background: rgba(0, 0, 0, 0.4);
      }

      #undo-btn:hover {
        transform: scale(1.1);
      }

      #backBtn {
        position: fixed;
        top: 20px;
        left: 20px;
        padding: 10px 18px;
        font-size: 20px;
        border-radius: 10px;
        border: 3px solid white;
        background: rgba(0, 0, 0, 0.4);
        color: white;
        cursor: pointer;
        z-index: 1000;
      }

      #backBtn:hover {
        transform: scale(1.1);
      }

      @keyframes shake {
        0% {
          transform: translateX(0);
        }
        20% {
          transform: translateX(-5px);
        }
        40% {
          transform: translateX(5px);
        }
        60% {
          transform: translateX(-5px);
        }
        80% {
          transform: translateX(5px);
        }
        100% {
          transform: translateX(0);
        }
      }

      .shake {
        animation: shake 0.5s ease;
      }
    </style>
  </head>
  <body>
    <main>
      <button id="backBtn">‚Üê Zur√ºck</button>

      <div class="salad-bowl-container">
        <img
          src="../../../../../pictures/schlaupause_deutsch_salatsch√ºssel_hintergrund-img_freigestellt.png"
          alt="Tisch mit gl√§serner Salatsch√ºssel"
        />
        <div class="salad-word-icon"></div>
        <div class="salad-letters"></div>
      </div>

      <div class="solution-word"></div>

      <button id="undo-btn">‚¨ÖÔ∏è</button>
    </main>

    <script>
      const words = [
        { letters: ["B", "A", "U", "M"], icon: "üå≥" },
        { letters: ["H", "A", "U", "S"], icon: "üè†" },
        { letters: ["S", "C", "H", "U", "L", "E"], icon: "üè´" },
        { letters: ["B", "L", "U", "M", "E"], icon: "üå∏" },
        { letters: ["K", "A", "T", "Z", "E"], icon: "üê±" },
        { letters: ["H", "U", "N", "D"], icon: "üê∂" },
        { letters: ["V", "O", "G", "E", "L"], icon: "üê¶" },
        { letters: ["F", "I", "S", "C", "H"], icon: "üêü" },
        { letters: ["A", "P", "F", "E", "L"], icon: "üçé" },
        { letters: ["B", "A", "N", "A", "N", "E"], icon: "üçå" },
        { letters: ["S", "O", "N", "N", "E"], icon: "‚òÄÔ∏è" },
        { letters: ["W", "O", "L", "K", "E"], icon: "‚òÅÔ∏è" },
        { letters: ["S", "T", "U", "H", "L"], icon: "ü™ë" },
        { letters: ["T", "I", "S", "C", "H"], icon: "ü™ü" },
        { letters: ["F", "A", "H", "R", "R", "A", "D"], icon: "üö≤" },
        { letters: ["A", "U", "T", "O"], icon: "üöó" },
        { letters: ["B", "U", "C", "H"], icon: "üìò" },
        { letters: ["U", "H", "R"], icon: "‚è∞" },
        { letters: ["W", "E", "C", "K", "E", "R"], icon: "‚è∞" },
        { letters: ["S", "C", "H", "N", "E", "E"], icon: "‚ùÑÔ∏è" },
        { letters: ["R", "E", "G", "E", "N"], icon: "üåßÔ∏è" },
        { letters: ["F", "E", "U", "E", "R"], icon: "üî•" },
        { letters: ["S", "T", "E", "R", "N"], icon: "‚≠ê" },
        { letters: ["M", "O", "N", "D"], icon: "üåô" },
        { letters: ["Z", "A", "H", "N"], icon: "ü¶∑" },
        { letters: ["F", "E", "D", "E", "R"], icon: "ü™∂" },
        { letters: ["K", "I", "N", "D"], icon: "üßí" },
        { letters: ["F", "R", "E", "U", "N", "D"], icon: "ü§ù" },
        { letters: ["H", "E", "R", "Z"], icon: "‚ù§Ô∏è" },
        { letters: ["K", "O", "F", "F", "E", "R"], icon: "üß≥" },
        { letters: ["B", "A", "L", "L"], icon: "‚öΩ" },
        { letters: ["M", "A", "U", "S"], icon: "üê≠" },
        { letters: ["E", "I", "S"], icon: "üç¶" },
        { letters: ["K", "U", "C", "H", "E", "N"], icon: "üç∞" },
        { letters: ["P", "I", "N", "G", "U", "I", "N"], icon: "üêß" },
        { letters: ["T", "O", "R"], icon: "ü•Ö" },
        { letters: ["S", "T", "E", "I", "N"], icon: "ü™®" },
        { letters: ["K", "I", "N", "D"], icon: "üßí" },
        { letters: ["B", "L", "A", "T", "T"], icon: "üçÉ" },
        { letters: ["G", "L", "A", "S"], icon: "ü•õ" },
        { letters: ["T", "A", "S", "S", "E"], icon: "‚òï" },
        { letters: ["R", "O", "S", "E"], icon: "üåπ" },
        { letters: ["H", "A", "U", "S"], icon: "üè°" },
        { letters: ["F", "E", "N", "S", "T", "E", "R"], icon: "ü™ü" },
        { letters: ["S", "T", "R", "A", "N", "D"], icon: "üèñÔ∏è" },
      ]; //Array mit W√∂rtern variabler L√§nge

      const bowlLettersContainer = document.querySelector(".salad-letters");
      const bowlWordIconContainer = document.querySelector(".salad-word-icon");
      const undoButton = document.getElementById("undo-btn");
      const solutionWordContainer = document.querySelector(".solution-word");

      let currentWordObject = getRandomWord();
      let targetWordLetters = currentWordObject.letters;
      let shuffledBowlLetters = shuffleLetters(targetWordLetters);
      let kidSelectedLetters = [];
      let solutionLetterSlots = [];

      function getRandomWord() {
        const randomIndex = Math.floor(Math.random() * words.length);
        return words[randomIndex];
      }

      function shuffleLetters(lettersArray) {
        const letters = [...lettersArray];
        for (let i = letters.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [letters[i], letters[j]] = [letters[j], letters[i]];
        }
        return letters;
      }

      //Hier werden die L√ºcken f√ºr das L√∂sungswort erstellt, abh√§ngig von der Wortl√§nge
      function createSolutionSlots() {
        solutionWordContainer.innerHTML = "";
        solutionLetterSlots = [];
        for (let i = 0; i < targetWordLetters.length; i++) {
          const slot = document.createElement("span");
          slot.classList.add("solution-slot");
          slot.textContent = "_";
          solutionWordContainer.appendChild(slot);
          solutionLetterSlots.push(slot);
        }
      }

      function showWordInBowl(letters) {
        bowlLettersContainer.innerHTML = "";
        bowlWordIconContainer.textContent = currentWordObject.icon;

        letters.forEach((letter) => {
          const letterSpan = document.createElement("span");
          letterSpan.textContent = letter;
          letterSpan.classList.add("bowl-letter");

          letterSpan.addEventListener("click", () => {
            kidSelectedLetters.push(letter);
            updateSolutionSlots();
            letterSpan.remove();
            if (kidSelectedLetters.length === targetWordLetters.length) {
              checkKidSolutionAndGiveFeedback();
            }
          });

          bowlLettersContainer.appendChild(letterSpan);
        });
      }

      // Hier werden die L√ºcken mit den vom Nutzer ausgew√§hlten Buchstaben aktualisiert
      function updateSolutionSlots() {
        solutionLetterSlots.forEach((slot, i) => {
          slot.textContent = kidSelectedLetters[i] || "_";
          slot.style.backgroundColor = "";
        });
      }

      function checkKidSolutionAndGiveFeedback() {
        const kidWord = kidSelectedLetters.join("");
        const correctWord = targetWordLetters.join("");
        //gleich, aber jetzt dynamisch f√ºr variable Wortl√§nge
        if (kidWord === correctWord) {
          let points = parseInt(localStorage.getItem("points")) || 0;
          points += 1;
          localStorage.setItem("points", points);
          solutionLetterSlots.forEach((slot) => {
            slot.style.backgroundColor = "#a8e6a3";
          });
          setTimeout(showNextWord, 1000);
        } else {
          solutionLetterSlots.forEach((slot) => slot.classList.add("shake"));
          setTimeout(() => {
            solutionLetterSlots.forEach((slot) =>
              slot.classList.remove("shake"),
            );
          }, 500);
        }
      }

      function showNextWord() {
        currentWordObject = getRandomWord();
        targetWordLetters = currentWordObject.letters;
        shuffledBowlLetters = shuffleLetters(targetWordLetters);
        kidSelectedLetters = [];
        createSolutionSlots(); // Erstellt neue L√ºcken basierend auf der neuen Wortl√§nge
        showWordInBowl(shuffledBowlLetters);
      }

      undoButton.addEventListener("click", () => {
        if (kidSelectedLetters.length === 0) return;

        const lastLetter = kidSelectedLetters.pop();
        updateSolutionSlots();

        const letterSpan = document.createElement("span");
        letterSpan.textContent = lastLetter;
        letterSpan.classList.add("bowl-letter");

        letterSpan.addEventListener("click", () => {
          kidSelectedLetters.push(lastLetter);
          updateSolutionSlots();
          letterSpan.remove();
          if (kidSelectedLetters.length === targetWordLetters.length) {
            checkKidSolutionAndGiveFeedback();
          }
        });

        bowlLettersContainer.appendChild(letterSpan);
      });

      document.getElementById("backBtn").onclick = () => {
        window.location.href = "./buchstabensalatauswahl.html";
      };

      createSolutionSlots();
      showWordInBowl(shuffledBowlLetters);
    </script>
  </body>
</html>
